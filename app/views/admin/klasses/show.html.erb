<fieldset class="fieldset bg-base-200 border-base-300 rounded-box w-full border p-4 flex flex-row">
  <div>
    <% if @klass %>
    <%= render "admin/shared/drawer", item: @klass, drawer_id: "drawer-klass-show", button_name: "班级详情", drawer_width: "180", drawer_content: "admin/klasses/form" %>
    <% end %>
  </div>
  <div>
    <%= render partial: "admin/shared/drawer", locals: { item: Klass.new, drawer_id: "drawer-klass-new", button_name: "创建班级", drawer_width: "180", drawer_content: "admin/klasses/form" } %>
  </div>
</fieldset>
<div class="flex flex-row min-h-1/2 overflow-auto">
  <div class="basis-1/3 min-h-dvh bg-base-200">
    <%= render "admin/klasses/menu", grades: @grades %>
  </div>
  <div class="basis-2/3 w-full flex flex-row">
    <fieldset class="fieldset bg-base-200 border-base-300 rounded-box w-full border p-4">
      <legend class="fieldset-legend">课程</legend>
      <div class="overflow-x-auto rounded-box border border-base-content/5 bg-base-100">
        <table class="table table-sm">
          <!-- head -->
          <thead>
            <tr>
              <th>课次</th>
              <% @klass.students.each do |student| %>
              <th><%= student.name %></th>
              <% end %>
              <th>操作</th>
            </tr>
          </thead>
          <tbody>
            <!-- row 1 -->
            <% @klass.courses.each do |course| %>
            <tr>
              <th><%= course.seq %></th>
              <% @klass.students.each do |student| %>
              <td>
                <% if course.started? %>
                <%= render "admin/klasses/attendance_dropdown", course: course, student: student %>
                <% else %>
                未开课
                <% end %>
              </td>
              <% end %>
              <td>
                <% if course.started? %>
                <%= link_to "全到", "#", class: "btn btn-xs btn-primary" %>
                <% else %>
                <%= button_to "开课", start_admin_klass_course_path(@klass, course), method: :put, class: "btn btn-xs btn-primary" %>
                <% end %>
              </td>
            </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </fieldset>
  </div>
</div>

